## IIS WebDAV
És un protocol que serveix per la transferència i gestió de fitxers de forma col·laborativa i remota, de la mateixa manera que ho fa SMB o FTP, en un entorn web. En principi, està pensat per utilitzar-se a servidors Windows, tot i que actualment també suporta altres sistemes operatius. Pot estar protegit per credencials vàlides per poder accedir, en forma de HTTP-GET.
Per explotar aquest servei, cal:
1. Trobar el directori sota el qual treballa
2. Aconseguir credencials vàlides
3. Pujar un arxiu amb el payload desitjat
```bash
cadaver [url] # Connectar-se a WebDav a través de terminal
	ls # Llistar directori
	put # Pujar arxiu
	cd # Canviar directori
	less # Obrir arxiu (no s'executa)
	get # Descarregar arxiu
	delete # Eliminar arxiu

davtest --url [] # Escaneig de WebDav
	--auth [user:pass] # Credencials
	--uploadfile [file] # Pujar arxiu
	--uploadloc [path] # Localització de l'arxiu

hydra -L [user_file] -P [pass_file] http-get://[host]/[webdav_dir]
```
## EternalBlue
Classificada com CVE-2017-0144 p MS17-010, és una vulnerabilitat al protocol SMBv1 de Buffer Overflow descoberta per la NSA, guardada com un 0day i filtrada posteriorment per The Shadow Brokers, juntament amb altres exploits i el framework _FuzzBunch_. Afecta únicament a Windows, des de la versió Vista fins a Windows Server 2008 (R1 i R2), i permet execució remota de comandes amb privilegis de sistema.
MetaSploit té el seu propi mòdul per explotar-la però hi ha altres exploits fora d'aquest framework, com [AutoBlue-MS17-010](https://https://github.com/3ndG4me/AutoBlue-MS17-010).
## BlueKeep
Vulnerabilitat de RDP descoberta per l'equip de seguretat de Windows. Com no ha estat reportada externament, va ser arreglada sense cap tipus de prova de concepte associada, tot i que s'han aconseguit fer alguns exploits. Permet executar comandes en un espai de memòria dedicat al kernel, i per tant amb privilegis de sistema.
> _S'ha d'anar amb compte a l'hora d'explotar BlueKeep. D'una banda, és important verificar que l'exploit que s'utilitzarà sigui vàlid i no sigui maliciós cap a l'atacant. D'altra, perquè trastejar amb l'espai de memòria del kernel pot provocar una caiguda del sistema i pèrdua de dades._
## PsExec
Si tenim credencials SMB vàlides o un hash NTLM vàlid, i està activada la signatura de missatges en el servei SMB, es pot obtenir una consola interactiva a través del script de Python PsExec, d'Impacket.
```bash
psexec [user]@[host] cmd # farà prompt per la contrasenya
```
## RDP
És un protocol que s'utilitza per poder controlar de forma remota un host a través de la seva interfície gràfica, com si fos una màquina virtual. Les credencials que utiltiza per accedir-hi són les mateixes que les d'inici de sessió, i l'usuari ha d'estar inclós al grup de "Remote Desktop Users" per poder entrar-hi.
```bash
xfreerdp /u:[user] /p:[pass] /v:[IP]
```
## WinRM
La eina per excel·lència dels administradors de sistemes que treballen amb xarxes Windows. WinRM serveix per poder administrar de forma remota, sempre dins de la xarxa interna i sense interfície gràfica, un conjunt de hosts, de manera que es poden fer configuracions simultànies.
```bash
evil-winrm -i [ip] -U [user] -P [pass]
```

> La màquina per excel·lència per practicar l'explotació de sistemes Windows és _Blue_ de HTB. Aquí [la resolució de S4vitar.](https://www.youtube.com/watch?v=92XycxcAXkI)